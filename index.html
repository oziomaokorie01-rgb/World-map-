
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Espresso Systems World Map</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- Dark Theme Tiles -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet.globe@0.0.4/dist/leaflet.globe.css" />
  <script src="https://unpkg.com/leaflet.globe@0.0.4/dist/leaflet.globe.min.js"></script>

  <style>
    body { margin: 0; background: #1e1e1e; font-family: Arial, sans-serif; color: #fff; }
    #map { width: 100vw; height: 100vh; }
    .title {
      position: absolute; top: 20px; left: 70px;
      font-size: 20px; font-weight: bold; z-index: 1000;
    }
    .logo {
      position: absolute; top: 15px; left: 15px;
      width: 40px; height: 40px; z-index: 1000;
    }
    .toggle-btn {
      position: absolute; top: 20px; right: 20px;
      padding: 8px 12px; background: #333; color: #fff;
      border: none; border-radius: 6px; cursor: pointer;
      z-index: 1000;
    }
    .leaflet-popup-content img {
      max-width: 200px; display: block; margin-bottom: 8px;
    }
  </style>
</head>
<body>
  <img src="images/logo.png" alt="Logo" class="logo">
  <div class="title">Espresso Systems World Map</div>
  <button class="toggle-btn" onclick="toggleView()">üåç Toggle Globe</button>
  <div id="map"></div>

  <script>
    // Events Data
    const events = [
      {id:1,name:"Denver",coords:[39.7392,-104.9903],img:"images/denver.png",type:"past",desc:"Composability Day in Denver, an afternoon event where we discussed all things composability."},
      {id:2,name:"San Francisco",coords:[37.7749,-122.4194],img:"images/san-francisco.png",type:"past",desc:"Espresso Brews in SF with Electric Capital during ETHSF week."},
      {id:3,name:"New York",coords:[40.7128,-74.0060],img:"images/new-york.png",type:"past",desc:"Espresso CEO Benafisch speaking at mainnet in New York."},
      {id:4,name:"Cannes",coords:[43.5528,7.0174],img:"images/cannes.png",type:"past",desc:"Espresso in Cannes with p√©tanque tourney and crypto chats."},
      {id:5,name:"Bangkok",coords:[13.7563,100.5018],img:"images/bangkok.png",type:"past",desc:"Back to the Future event in Bangkok featuring Cartesi + Espresso apps."},
      {id:6,name:"Brussels",coords:[50.8503,4.3517],img:"images/brussels.png",type:"past",desc:"Cartesi x Espresso at EthCC Brussels exploring modular blockchain futures."},
      {id:7,name:"Berlin",coords:[52.5200,13.4050],img:"images/berlin.png",type:"past",desc:"Espresso Systems Product Manager judging at ETHBerlin."},
      {id:8,name:"Seoul",coords:[37.5665,126.9780],img:"images/seoul.png",type:"future",desc:"Espresso happy hour in Seoul with swag and top-secret drop."},
      {id:9,name:"Buenos Aires",coords:[-34.6037,-58.3816],img:"images/buenos-aires.png",type:"future",desc:"Future Espresso meetup in Buenos Aires (details coming soon)."},
    ];

    // Icons (smaller sizes)
    const pastIcon = L.icon({
      iconUrl: 'images/past.png',
      iconSize: [20, 20]
    });
    const futureIcon = L.icon({
      iconUrl: 'images/future.png',
      iconSize: [20, 20]
    });

    // Flat Map
    const map = L.map('map').setView([20, 0], 2);
    const darkTiles = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; <a href="https://www.openstreetmap.org/">OSM</a> contributors'
    }).addTo(map);

    // Add markers
    events.forEach(ev => {
      const marker = L.marker(ev.coords, { icon: ev.type === "past" ? pastIcon : futureIcon }).addTo(map);
      marker.bindPopup(`
        <b>${ev.name}</b><br>
        <img src="${ev.img}" alt="${ev.name}"><br>
        <small>${ev.desc}</small>
      `);
    });

    // Globe view setup
    let globe = null;
    function toggleView() {
      if (globe) {
        globe.remove();
        globe = null;
        map._container.style.display = "block";
      } else {
        map._container.style.display = "none";
        globe = L.globe(document.getElementById('map')).setView([20,0],2);
        events.forEach(ev => {
          const marker = L.marker(ev.coords, { icon: ev.type === "past" ? pastIcon : futureIcon }).addTo(globe);
          marker.bindPopup(`<b>${ev.name}</b><br><img src="${ev.img}" alt="${ev.name}"><br><small>${ev.desc}</small>`);
        });
      }
    }
  </script>
</body>
</html>
